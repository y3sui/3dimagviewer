<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Minimal GLTF Viewer</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100%;
            background: #000;
        }

        #viewer {
            position: fixed;
            inset: 0;
        }
    </style>
</head>
<body>
    <div id="viewer"></div>

    <script type="module">
        import * as THREE from "https://esm.run/three@0.167.0";
        import { GLTFLoader } from "https://esm.run/three@0.167.0/examples/jsm/loaders/GLTFLoader.js";
        import { OrbitControls } from "https://esm.run/three@0.167.0/examples/jsm/controls/OrbitControls.js";

        const container = document.getElementById('viewer');

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.01, 1000);
        camera.position.set(0, 0, 3);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;

        const hemiLight = new THREE.HemisphereLight(0xffffff, 0x222222, 1.0);
        scene.add(hemiLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
        dirLight.position.set(5, 10, 7.5);
        scene.add(dirLight);

        const loader = new GLTFLoader();
        const MODEL_URL = 'haus2.glb'; // or 'model.gltf'

        loader.load(
            MODEL_URL,
            (gltf) => {
                const root = gltf.scene || gltf.scenes[0];
                scene.add(root);

                const box = new THREE.Box3().setFromObject(root);
                const size = new THREE.Vector3();
                const center = new THREE.Vector3();
                box.getSize(size);
                box.getCenter(center);

                root.position.sub(center);

                const maxDim = Math.max(size.x, size.y, size.z);
                const fitDistance = maxDim * 1.5;
                const fov = camera.fov * (Math.PI / 180);
                const cameraDistance = fitDistance / Math.tan(fov / 2);

                camera.position.set(0, 0, cameraDistance);
                camera.near = cameraDistance / 100;
                camera.far = cameraDistance * 100;
                camera.updateProjectionMatrix();

                controls.update();
            },
            undefined,
            (error) => {
                console.error('Error loading model:', error);
            }
        );

        window.addEventListener('resize', () => {
            const w = window.innerWidth;
            const h = window.innerHeight;
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
            renderer.setSize(w, h);
        });

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
